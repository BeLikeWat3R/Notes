
**Identifying File Types:** 

In order to determine the file type of the sample use  `CFF  Explorer` or something similar

	MZ (4D 5A) is the magic number of executables

-----------------------------------------

**Fingerprinting**: 

In order to get a hash of our sample, we can use the `Get-FileHash` PowerShell cmdlet

```powershell

Get-FileHash -Algorithm [hashing algorithm] [file path]
```

-----------------------------------------

**Hash Lookup:** 

Run the hash through VirusTotal or something similar to see if it hits & information about variations, etc. Check details for the IMPHASH.

-----------------------------------------

**Import Hashing (IMPHASH):** 

This hash is derived from the import functions of a PE. It functions by converting all imported function names to lowercase. Next, the DLL names and function names are fused together and arranged alphabetically. An MD5 hash is generated from the resulting string. This to say, two PEs with identical import functions will share the same IMPHASH. 

Use the Python module `pefile` to compute the IMPHASH

```python
import sys
import pefile
import peutils

pe_file = sys.argv[1]
pe = pefile.PE(pe_file)
imphash = pe.get_imphash()

print(imphash)
```


Fuzzy Hashing (SSDEEP): 

Also called context-triggered piecewise hashing (CTPH) is a technique designed to compute the hash value based on similarity between two files. It works by slicing the file into smaller fixed size blocks and then calculates the hash for each block. The values are then meshed together to calculate the final fuzzy hash. 

The SSDEEP algorithm allocates more weight to longer sequences of common blocks, which makes it very effective at identifying files that have minor modifications/are similar but not identical.

To calculate the SSDEEP hash, navigate to the directory it is in - 

```cmd
ssdeep.exe [file path]
```


Section Hashing: 

Allows for a method to determine sections of a PE that have been modified, very useful for identifying variations in malware. 

It works by calculating the hash of each section. When comparing two PEs, if the hash of the sections in the two files match, it suggests that the particular section has not been modified between the two versions of the file. 

Use the Python module `pefile` again to compute the section hash

```python
import sys
import pefile
pe_file = sys.argv[1]
pe = pefile.PE(pe_file)
for section in pe.sections:
	print (section.Name, "MD5 hash:", section.get_hash_md5())
	print (section.Name, "SHA256 hash:",  section.get_hash_sha256())
```

